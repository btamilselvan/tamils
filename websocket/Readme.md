> Uses the TCP connections.
> The first request is similar to http but gets upgraded to websocket to have a persistent connection.
> persistent connections

# Spring-boot Elements:

> STOMP protocol (over websocket) and STOMP messages
> Message-handling controller
	> @MessageMapping - (just like /path), mapped to a specific end-point (to receive messages from clients).
	> @SendTo - send reply to a specific destination. Client subscribe to this destination to receive message from server.
> WebsocketMessageBroker
	> @EnableWebSocketMessageBroker - to enable websocket messaging. The configuration class to enable message brokers, specify destinations and message prefixes, if any. Also, enables and registers the stomp end-points, and fall-back mechanism.
User to User messages:
> use SimpMessagingTemplate.convertAndSendToUser method in MessageHandlers
> send the "To user" in the message and pass the to user to convertAndSendToUser method. the destination prefix should be /user (configurable in the message broker)
> subscribe to user specific messages in the web (something like /user/{username}/destination
	
# Security
> Configure websecurity and websocket security
> Allow connect requests go thru spring websecurity.
> Make the websocket security filter high precedence to take control over the inbound channel validation
> obtain token using regular login workflow and send the token in websocket request headers
> read the headers in websocket security filter (configureClientInboundChannel) and validate the token for CONNECT commands

	 
# Message Broker
> Maintains the client subscription details and route the messages to the clients.
> Messages can be generated by websocket client as well from server side application.
> The messages generated from server side are route to message broker via broker channel which then routed to a client via outbound channel.
> The incoming messages are received via inbound channel and routed to either Message broker or to the message controller based on the destination prefix.
> Configure app destination prefix to route the messages to a specific Message controller.

```
	registry.setApplicationDestinationPrefixes(Constants.APP_PREFIX, Constants.CHAT_PREFIX);
```
> Configure Message broker with one or more prefixes that it can handle.
 
 ```
	registry.enableSimpleBroker(Constants.TOPIC_DESTINATION_PREFIX, Constants.USER_DESTINATION_PREFIX);
```
> Generate a message on the server and send to the Message broker which then broadcasted to the subscribers.

```
	 mt.convertAndSendToUser(message.getTo(), Constants.CHAT_DESTINATION_SUFFIX, new Reply(message.getName() + ": " + message.getContent()));
```
 